local version = "V0.6.1"

local Config = {
	FlySpeed = 3;
	Fly_Up = Enum.KeyCode.Q; -- Fly forward, backward, left and right are controlled by WASD.
	Fly_Down = Enum.KeyCode.E; -- Change the letter on the end to configure the controls for up and down.
	Hammer_BTool_Undo = Enum.KeyCode.LeftBracket; --Key to undo btools delete
}

local branding = {
	DragFrameColour = Color3.fromRGB(200, 200, 200),
	ButtonColour = Color3.fromRGB(100, 100, 200),
	ButtonTextColour = Color3.fromRGB(255, 255, 255),
	ButtonFontSize = 14,
	HeadingButtonFontSize = 22,
	HeadingColour = Color3.fromRGB(106, 106, 106),
	Font = Enum.Font.Gotham
} 

local Teleports = {
	['Hiding Spot'] = {Vector3.new(-2308, 5, 604), 1};
	['Outside BoE'] = {Vector3.new(93.5, 6, 1900), 2};
	['BoE Bank Vault'] = {Vector3.new(221, -218, 2035), 3};
	['BoE Hiding Spot'] = {Vector3.new(241, -218, 2019), 4};
	['Outside HSBC'] = {Vector3.new(-2245, 4, -1319), 5};
	['HSBC Vault'] = {Vector3.new(-2292, -109, -1370), 6};
	['HSBC Hiding Spot 1'] = {Vector3.new(-2309, -97, -1370), 7};
	['HSBC Hiding Spot 2'] = {Vector3.new(-2221, -109, -1394), 8};
	['Gun Shop'] = {Vector3.new(-98, 5, -1296), 9};
	['Teleport Room'] = {Vector3.new(-80, -49, 276), 10};
	['Buckingham Roof'] = {Vector3.new(-544, 80, 4523), 11};
	['Buckingham Entrance'] = {Vector3.new(-589, 5, 4454), 12};
	['Throne Room'] = {Vector3.new(-733, -215, 3952), 13};
	['Metropolitan Police'] = {Vector3.new(-512, 5, 341), 14};
	['Fire Department'] = {Vector3.new(-243, -197, 4567), 15};
	['RASP Uniform Room'] = {Vector3.new(-619, -71, 801), 16};
	['Parliament ConfRoom'] = {Vector3.new(-760, -73, 724), 17};
	['BAF'] = {Vector3.new(-959, 46, 153), 18};
	['BAF Secret Room'] = {Vector3.new(-1098, 46, 188), 19};
	['Face'] = {Vector3.new(-163, 5, 103), 20};
}

local function createGui()
	local chatService = game:GetService('Chat')
	local userInputService = game:GetService('UserInputService')
	local tweenService = game:GetService('TweenService')
	local runService = game:GetService('RunService')
	local starterGui = game:GetService('StarterGui')
	local players = game:GetService('Players')
	local localplayer = players.LocalPlayer
	local backpack = localplayer.Backpack
	local playerGui = localplayer.PlayerGui
	local character = localplayer.Character or localplayer.CharacterAdded:Wait()
	local humanoidRootPart = character:WaitForChild('HumanoidRootPart')
	local humanoid = character:WaitForChild('Humanoid')
	local spectatePart = Instance.new('Part', workspace)
	spectatePart.Size = Vector3.new(1, 1, 1)
	spectatePart.Transparency = 1
	spectatePart.Anchored = true
	spectatePart.CanCollide = false

	local originJumpPower = humanoid.JumpPower
	local originWalkSpeed = 16
	
	local currentCamera = workspace.CurrentCamera
	
	local replicatedStorage = game:GetService('ReplicatedStorage')
	local tools = replicatedStorage:WaitForChild('Tools'):GetChildren()
		local killPlayerConfig = {
		replicatedStorage.Tools.Railgun;
		Vector3.new(-138, -50, 176);
		Vector3.new(33, -315, -79);
		999999;
		47;
		"";
		99999;
		2;
		playerGui.GunUI;
	}
	
	local gunShootEvent = replicatedStorage.Events.GunShoot
	local chatGui
	local spectateGui
	local gui = Instance.new('ScreenGui', playerGui)
	
	local dragFrame = Instance.new('Frame', gui)
	dragFrame.AnchorPoint = Vector2.new(0, 0.5)
	dragFrame.Size = UDim2.new(0.2, 0, 0.5, 0)
	dragFrame.Position = UDim2.new(0, 0, 0.25, 0)
	dragFrame.BorderSizePixel = 0
	dragFrame.BackgroundColor3 = branding.DragFrameColour
	dragFrame.ZIndex = 0
	dragFrame.Active = true
	dragFrame.Draggable = true
	dragFrame.ClipsDescendants = true
	
	local headingBackground = Instance.new('Frame', dragFrame)
	headingBackground.Size = UDim2.new(1, 0, 0.1, 0)
	headingBackground.BorderSizePixel = 0
	headingBackground.BackgroundColor3 = branding.HeadingColour
	headingBackground.ZIndex = dragFrame.ZIndex + 1
	
	local mainFrame = Instance.new('ScrollingFrame', dragFrame)
	mainFrame.AnchorPoint = Vector2.new(0.5, 0)
	mainFrame.Size = UDim2.new(0.9, 0, 0.85, 0)
	mainFrame.Position = UDim2.new(0.5, 0, 0.125, 0)
	mainFrame.BorderSizePixel = 0
	mainFrame.BackgroundTransparency = 1
	mainFrame.ScrollBarImageTransparency = 1
	mainFrame.ScrollBarThickness = 0
	mainFrame.CanvasSize = UDim2.new(0, 0, 2, 0)
	
	local UIGridLayout1 = Instance.new('UIGridLayout', mainFrame)
	UIGridLayout1.CellPadding = UDim2.new(0.1, 0, 0.002, 0)
	UIGridLayout1.CellSize = UDim2.new(1, 0, 0.05, 0)
	UIGridLayout1.HorizontalAlignment = Enum.HorizontalAlignment.Center
	UIGridLayout1.SortOrder = Enum.SortOrder.LayoutOrder
	
	local loadingFrame = Instance.new('TextLabel', dragFrame)
	loadingFrame.Size = UDim2.new(1, 0, 0.9, 0)
	loadingFrame.Position = UDim2.new(0, 0, 0.1, 0)
	loadingFrame.ZIndex = 10000
	loadingFrame.Text = 'City of London Exploit\n' .. version .. '\nLoading'
	loadingFrame.TextColor3 = Color3.fromRGB(0, 0, 0)
	loadingFrame.BackgroundColor3 = branding.DragFrameColour
	loadingFrame.Font = branding.Font
	loadingFrame.TextSize = branding.HeadingButtonFontSize
	loadingFrame.BorderSizePixel = 0
	loadingFrame.TextWrapped = true
	loadingFrame.LineHeight = 2
	
	spawn(function()
		local idx = 1
		while wait(0.4) do
			if idx > 3 then
				idx = 0
				loadingFrame.Text = 'City of London Exploit\n' .. version .. '\nLoading'
			else
				loadingFrame.Text = loadingFrame.Text .. '.'
			end
			idx = idx + 1
		end
	end)
	
	spectateGui = Instance.new('ScreenGui', gui)
	spectateGui.Enabled = false
	
	local function createButton(name, order, parent, anchor, pos, size, transparency, heading)
		local button = Instance.new('TextButton', parent)
		button.BorderSizePixel = 0
		button.BackgroundColor3 = branding.ButtonColour
		button.TextColor3 = branding.ButtonTextColour
		if (transparency) then
			if (transparency > 0) then
				button.BackgroundTransparency = transparency
				button.TextColor3 = Color3.new(1 - branding.ButtonTextColour.R, 1 - branding.ButtonTextColour.G, 1 - branding.ButtonTextColour.B)
			end
		end
		button.Font = branding.Font
		button.TextSize = branding.ButtonFontSize
		if (heading) then
			button.TextSize = branding.HeadingButtonFontSize
		end
		button.Text = name	
		button.Name = name	
		if (not(parent:IsA('ScreenGui'))) then
			button.ZIndex = parent.ZIndex + 1
		end
		if (order) then
			button.LayoutOrder = order
		end
		if (anchor) then
			button.AnchorPoint = anchor
		end
		if (pos) then
			button.Position = pos
		end
		if (size) then
			button.Size = size
		end
		return button
	end
	
	local nextButton = createButton('Next Player', nil, spectateGui, nil, UDim2.new(0.88,0,0.58,0), UDim2.new(0.1,0,0.07,0))
	local prevButton = createButton('Previous Player', nil, spectateGui, nil, UDim2.new(0.88,0,0.66,0), UDim2.new(0.1,0,0.07,0))
	local freeCamButton = createButton('Freecam', nil, spectateGui, nil, UDim2.new(0.88,0,0.74,0), UDim2.new(0.1,0,0.07,0))
	freeCamButton.Text = 'Freecam: Off'
	
	local currentWalkSpeed = originWalkSpeed
	local flyingButtonDebounce = false
	local flying = false
	local modifier = 0
	local plrNum = 1
	
	prevButton.MouseButton1Down:connect(function()
		plrNum = plrNum - 1
		if (plrNum < 1) then
			plrNum = #players:GetPlayers()
		end
		local playerHead = players:GetPlayers()[plrNum].Character.Head
		currentCamera.CameraSubject = playerHead
		spectatePart.Position = playerHead.Position
	end)
	
	nextButton.MouseButton1Down:connect(function()
		plrNum = plrNum + 1
		if (plrNum > #players:GetPlayers()) then
			plrNum = 1
		end
		local playerHead = players:GetPlayers()[plrNum].Character.Head
		currentCamera.CameraSubject = playerHead
		spectatePart.Position = playerHead.Position
	end)
	
	spawn(function()
		userInputService.InputBegan:Connect(function(input)
			if (flying) then
				if (input.KeyCode == Config.Fly_Up) then
					modifier = 1
				elseif (input.KeyCode == Config.Fly_Down) then
					modifier = -1
				end
			end
		end)
		
		userInputService.InputEnded:Connect(function(input)
			if (flying) then
				if (input.KeyCode == Config.Fly_Up or input.KeyCode == Config.Fly_Down) then
					modifier = 0
				end
			end
		end)
		
		runService.RenderStepped:Connect(function()
			if (flying) then
				currentCamera.CameraSubject = spectatePart
				humanoid.JumpPower = 0
				humanoid.WalkSpeed = 0
				spectatePart.Position = spectatePart.Position + Vector3.new(0, modifier * Config.FlySpeed, 0)
				spectatePart.CFrame = spectatePart.CFrame * CFrame.new(Vector3.new(humanoid.MoveDirection.X * Config.FlySpeed, humanoid.MoveDirection.Y * Config.FlySpeed, humanoid.MoveDirection.Z * Config.FlySpeed))
			end
		end)
	end)
	
	freeCamButton.MouseButton1Down:Connect(function()
		if (flyingButtonDebounce) then return end
		flyingButtonDebounce = true
		if (plrNum > #players:GetPlayers()) then
			plrNum = 1
		end
		if (flying) then
			freeCamButton.Text = 'Freecam: Off'
			currentCamera.CameraSubject = players:GetPlayers()[plrNum].Character.Head
			humanoid.JumpPower =  originJumpPower
			humanoid.WalkSpeed = currentWalkSpeed
		else
			freeCamButton.Text = 'Freecam: On'
			spectatePart.Position = players:GetPlayers()[plrNum].Character.HumanoidRootPart.Position
		end
		flying = not(flying)
		flyingButtonDebounce = false
	end)

	chatGui = Instance.new('ScreenGui', gui)
	chatGui.Enabled = false

	local chatFrameDrag = Instance.new('Frame', chatGui)
	chatFrameDrag.AnchorPoint = Vector2.new(0.5, 1)
	chatFrameDrag.Size = UDim2.new(0.4, 0, 0.4, 0)
	chatFrameDrag.Position = UDim2.new(0.5, 0, 1, 0)
	chatFrameDrag.BackgroundTransparency = 1
	chatFrameDrag.Active = true
	chatFrameDrag.Draggable = true
	chatFrameDrag.ZIndex = 10000000

	local chatFrame = Instance.new('ScrollingFrame', chatFrameDrag)
	chatFrame.Size = UDim2.new(1, 0, 1, 0)
	chatFrame.BackgroundColor3 = Color3.new(200, 200, 200)
	chatFrame.VerticalScrollBarPosition = mainFrame.VerticalScrollBarPosition
	chatFrame.ScrollBarImageColor3 = mainFrame.ScrollBarImageColor3
	chatFrame.ScrollBarThickness = mainFrame.ScrollBarThickness
	chatFrame.BorderSizePixel = 0
	chatFrame.CanvasSize = UDim2.new(0, 0, 1, 0)
	chatFrame.ZIndex = 0

	local chatFrameGridLayoutUI = Instance.new('UIGridLayout', chatFrame)
	chatFrameGridLayoutUI.CellPadding = UDim2.new(0.1, 0, 0, 0)
	chatFrameGridLayoutUI.CellSize = UDim2.new(1, 0, 0.15, 0)
	chatFrameGridLayoutUI.HorizontalAlignment = Enum.HorizontalAlignment.Center
	chatFrameGridLayoutUI.SortOrder = Enum.SortOrder.LayoutOrder

	local function chatted(player, message)
		local frame  = Instance.new('TextLabel', chatFrame)
		frame.BackgroundTransparency = 1
		frame.Text = '[' .. player.Name .. ']: ' .. message
		frame.TextColor3 = Color3.fromRGB(0, 0, 0)
		frame.TextXAlignment = Enum.TextXAlignment.Left
		frame.TextYAlignment = Enum.TextYAlignment.Top
		frame.TextWrapped = true

		local chatFrames = (#chatFrame:GetChildren() - 1)

		chatFrameGridLayoutUI.CellPadding = UDim2.new(0.1, 0, (0.001 / chatFrames), 0)
		chatFrameGridLayoutUI.CellSize = UDim2.new(1, 0, (0.08 / chatFrames), 0)
		chatFrame.CanvasSize = UDim2.new(0, 0, (1 * chatFrames), 0)
	end
	
	players.PlayerAdded:Connect(function(player)
		player.Chatted:Conenct(function(message)
			chatted(player, message)
		end)
	end)
	
	for _, player in pairs(players:GetPlayers()) do
		player.Chatted:Connect(function(message)
			chatted(player, message)
		end)
	end

	local function createFrame()
		local createdFrame = Instance.new('ScrollingFrame', dragFrame)
		createdFrame.AnchorPoint = mainFrame.AnchorPoint
		createdFrame.Size = mainFrame.Size
		createdFrame.Position = mainFrame.Position
		createdFrame.VerticalScrollBarPosition = mainFrame.VerticalScrollBarPosition
		createdFrame.ScrollBarImageColor3 = mainFrame.ScrollBarImageColor3
		createdFrame.ScrollBarThickness = mainFrame.ScrollBarThickness
		createdFrame.BorderSizePixel = 0
		createdFrame.BackgroundTransparency = 1
		createdFrame.ZIndex = 2
		createdFrame.CanvasSize = UDim2.new(0, 0, 10, 0)
		createdFrame.Visible = false
	
		local createdUIGridLayout = UIGridLayout1:Clone()
		createdUIGridLayout.Parent = createdFrame
	
		return createdFrame
	end
	
	local Frames = {
		Cars = createFrame();
		Tools = createFrame();
		['Legit Tools'] = createFrame();
		Teleport = createFrame();
		['Teleport To Player'] = createFrame();
		Speed = createFrame();
		['Play Sound'] = createFrame();
		['Kill Player(s)'] = createFrame();
	}
	
	wait()
	
	Frames['Speed'].CanvasSize = UDim2.new(0, 0, 1, 0)
	Frames['Speed'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , 0.02, 0) 
	Frames['Speed'].UIGridLayout.CellSize = UDim2.new(1, 0 , 0.1, 0)
	
	Frames['Play Sound'].CanvasSize = UDim2.new(0, 0, 1, 0)
	Frames['Play Sound'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , 0.02, 0) 
	Frames['Play Sound'].UIGridLayout.CellSize = UDim2.new(1, 0 , 0.1, 0)  

	Frames['Kill Player(s)'].CanvasSize = UDim2.new(0, 0, 1, 0)
	Frames['Kill Player(s)'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , 0.02, 0) 
	Frames['Kill Player(s)'].UIGridLayout.CellSize = UDim2.new(1, 0 , 0.1, 0) 
	
	for idx, tool in pairs(tools) do
		local button = createButton(tool.Name, idx + 1, Frames['Tools']) 
		button.MouseButton1Down:Connect(function()
			local clone = tool:Clone()
	        for _, descendant in pairs(clone:GetDescendants()) do
				if descendant:IsA('BasePart') then
	            	descendant.Anchored = false
				end
	        end
			clone.Parent = backpack
		end)
		local buttonLegit = createButton(tool.Name, idx + 1, Frames['Legit Tools']) 
		buttonLegit.MouseButton1Down:Connect(function()
			local A_1 = tool.Name
			local Event = game:GetService("ReplicatedStorage")
			Event:FireServer(A_1)
		end)
		wait()
	end
	
	Frames['Tools'].CanvasSize = UDim2.new(0, 0, (2 * (#tools / 4)), 0)
	Frames['Tools'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , (0.002 / (#tools / 4)), 0) 
	Frames['Tools'].UIGridLayout.CellSize = UDim2.new(1, 0 , (0.05 / (#tools / 4)), 0)
	Frames['Legit Tools'].CanvasSize = UDim2.new(0, 0, (2 * (#tools / 4)), 0)
	Frames['Legit Tools'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , (0.002 / (#tools / 4)), 0) 
	Frames['Legit Tools'].UIGridLayout.CellSize = UDim2.new(1, 0 , (0.05 / (#tools / 4)), 0)  
	
	Frames.Cars.CanvasSize = UDim2.new(0, 0, (2 * (#replicatedStorage.Cars:GetChildren() / 4)), 0)
	Frames.Cars.UIGridLayout.CellPadding = UDim2.new(0, 0, 0, 0)
	Frames.Cars.UIGridLayout.CellSize = UDim2.new(1, 0, 1, 0)
	
	local carFrames = {}
	local counter = 1
	local buttonsFrame = createFrame()
	buttonsFrame.Position = UDim2.new(0, 0, 0, 0)
	buttonsFrame.CanvasSize = UDim2.new(1, 0, 1, 0)
	buttonsFrame.UIGridLayout.CellPadding = UDim2.new(0.1, 0 , (0.002 / (#replicatedStorage.Cars:GetChildren() / 4)), 0) 
	buttonsFrame.UIGridLayout.CellSize = UDim2.new(1, 0 , (0.05 / (#replicatedStorage.Cars:GetChildren() / 4)), 0)
	buttonsFrame.Parent = Frames.Cars
	buttonsFrame.Name = "Buttons"
	
	for key, carFolder in pairs(replicatedStorage.Cars:GetChildren()) do
		local tempFrame = createFrame()
		tempFrame.CanvasSize = UDim2.new(1, 0, 1, 0)
		tempFrame.UIGridLayout.CellPadding = buttonsFrame.UIGridLayout.CellPadding
		tempFrame.UIGridLayout.CellSize = buttonsFrame.UIGridLayout.CellSize
		tempFrame.Parent = Frames.Cars
		tempFrame.Name = carFolder.Name
		local counterBean = 1
		for _,car in pairs(carFolder:GetChildren()) do
			local button = createButton(car.Name, counterBean, tempFrame)
			counterBean = counterBean + 1
			button.MouseButton1Down:Connect(function()
				local A_1 = car.Name
				local A_2 = carFolder.Name
				local Event = game:GetService("ReplicatedStorage").Events.SpawnVehicleEvent
				Event:FireServer(A_1, A_2)
				wait(3)
				local root = game:GetService("Players").LocalPlayer.Character.HumanoidRootPart
				local pos = game:GetService("Workspace").SpawnedCars[game:GetService("Players").LocalPlayer.Name].DriveSeat.Position
				local offset = pos-root.Position
				root.CFrame = root.CFrame+offset 
			end)
		end
		table.insert(carFrames, key, tempFrame)
		local carFolderBtn = createButton(carFolder.Name, counter, buttonsFrame)
		carFolderBtn.MouseButton1Down:Connect(function()
			for _,thing in pairs(carFrames) do
				thing.Visible = false
			end
			for _,carFrameChild in pairs(Frames.Cars:GetChildren()) do
				pcall(function()
					if carFrameChild ~= tempFrame then
						carFrameChild.Visible = false
					end
				end)
			end
			tempFrame.Visible = true
		end)
		counter = counter + 1
	end 
	
	local teleportIdx = 1
	for key, teleport in pairs(Teleports) do
		local button = createButton(key, teleport[2], Frames['Teleport'])
		button.MouseButton1Down:Connect(function()
			if (character) then
				if (humanoidRootPart) then
					local offset = teleport[1] - humanoidRootPart.Position
					humanoidRootPart.CFrame = humanoidRootPart.CFrame + offset
				end
			end
		end)
		teleportIdx = teleportIdx + 1
		wait()
	end
	Frames['Teleport'].CanvasSize = UDim2.new(0, 0, (2 * (teleportIdx / 4)), 0)
	Frames['Teleport'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , (0.002 / (teleportIdx / 4)), 0) 
	Frames['Teleport'].UIGridLayout.CellSize = UDim2.new(1, 0 , (0.05 / (teleportIdx / 4)), 0) 
	
	local frameBackButton = createButton('Home', nil, dragFrame, Vector2.new(1, -1), UDim2.new(0.65, 0, 0, 0), UDim2.new(0.3, 0, 0.1, 0), 1, true)
	frameBackButton.MouseButton1Down:Connect(function()
		mainFrame.Visible = true
		for _, frame in pairs(Frames) do
			frame.Visible = false
		end
		for _, frame in pairs(carFrames) do
			frame.Visible = false
		end
	end)
	
	local autoFarmOn = true
	local playingSong = false
	local songID = "rbxassetid://"
	local songVolume = 0
	
	local mainScreenButtonFunctions = {
		Cars = {
			function()
				mainFrame.Visible = false
				for _,carFrameChild in pairs(Frames.Cars:GetChildren()) do
					pcall(function()
						if carFrameChild.Name == "Buttons" then
							carFrameChild.Visible = true
						else
							carFrameChild.Visible = false
						end
					end)
				end
				Frames.Cars.Visible = true
			end;
			1;
		};
		Tools = {
			function()
				mainFrame.Visible = false
				Frames['Tools'].Visible = true
			end;
			2;
		};
		['Legit Tools'] = {
			function()
				mainFrame.Visible = false
				Frames['Legit Tools'].Visible = true
			end;
			3;
		};
		['Click Teleport Tool'] = {
			function()		
				local tptool = Instance.new('Tool', backpack)
				tptool.RequiresHandle = false
				tptool.Name = 'Click To Teleport'
		
				tptool.Equipped:Connect(function(mouse)
					mouse.Button1Down:Connect(function()
						if (humanoidRootPart) then
							humanoidRootPart.CFrame = humanoidRootPart.CFrame + ((mouse.Hit.Position + Vector3.new(0, 2.5, 0)) - humanoidRootPart.Position)
						end
					end)
				end)
			end;
			4;
		};
		['Hammer BTool Bypass'] = {
			function()
				local Players = game:GetService("Players")
				local localPlayer = Players.LocalPlayer
				local backpack = localPlayer:WaitForChild("Backpack")
				local tool = Instance.new("Tool")
				local userInput = game:GetService("UserInputService")
				tool.RequiresHandle = false
				tool.CanBeDropped = false
				tool.Parent = backpack
				tool.Name = "Delete"
				local equipped = false
				tool.Equipped:Connect(function(mouse)
					equipped = true
					mouse.Button1Down:Connect(function()
						if mouse.Target and mouse.Target.Parent then
							local clone = mouse.Target:Clone()
							local cloneTransparency = clone.Transparency
							local cloneCollide = clone.CanCollide
							clone.Transparency = 1
							clone.CanCollide = false
							mouse.Target.Transparency = 1
							mouse.Target.CanCollide = false
							mouse.Target.Anchored = false
							mouse.Target.Size  = Vector3.new(0,0,0)
						end
					end)
					userInput.InputBegan:Connect(function(key)
						if key.KeyCode == Config.Hammer_BTool_Undo then
							clone.Transparency = cloneTransparency
							clone.CanCollide = cloneCollide
						end
					end)
				end)
			end;
			5;
		};
		['Clear Inv'] = { 
			function()
				backpack:ClearAllChildren()
				for _, descendant in pairs(character:GetDescendants()) do
					if (descendant:IsA('Tool') or descendant:IsA('HopperBin')) then
						descendant:Destroy()
					end
				end
			end;
			6;
		};
		['Spectate GUI'] = {
			function()
				if (spectateGui.Enabled) then
					currentCamera.CameraSubject = character.Humanoid
					flying = false
					flyingButtonDebounce = false
					mainFrame['Spectate GUI'].Text = 'Spectate GUI: Off'
					freeCamButton.Text = 'Freecam: Off'
					humanoid.WalkSpeed = currentWalkSpeed
				else
					if (plrNum > #players:GetPlayers()) then
						plrNum = 1
					end
					mainFrame['Spectate GUI'].Text = 'Spectate GUI: On'
					currentCamera.CameraSubject = players:GetPlayers()[plrNum].Character.Head
				end
				spectateGui.Enabled = not(spectateGui.Enabled)
			end;
			7;
		};
		Teleport = {
			function()
				mainFrame.Visible = false
				Frames['Teleport'].Visible = true
			end;
			8;
		};
		['Teleport To Player'] = {
			function()
				local currentPlayers = players:GetPlayers()
				for _, child in pairs(Frames['Teleport To Player']:GetChildren()) do
					if not child:IsA('UIGridLayout') then
						child:Destroy()
					end
					wait()
				end
				for idx, player in pairs(currentPlayers) do
					local button = createButton(player.Name, idx, Frames['Teleport To Player'])
					button.MouseButton1Down:Connect(function()
						local char = player.Character
						if (char) then
							local humRootPart = char:FindFirstChild('HumanoidRootPart')
							if (humRootPart) then
								character:SetPrimaryPartCFrame(humRootPart.CFrame)
							end
						end
					end)
					wait()
				end
				Frames['Teleport To Player'].CanvasSize = UDim2.new(0, 0, (2 * (#currentPlayers / 4)), 0)
				Frames['Teleport To Player'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , (0.002 / (#currentPlayers / 4)), 0) 
				Frames['Teleport To Player'].UIGridLayout.CellSize = UDim2.new(1, 0 , (0.05 / (#currentPlayers / 4)), 0) 

				mainFrame.Visible = false
				Frames['Teleport To Player'].Visible = true
			end;
			9;
		};
		Speed = {
			function()
				mainFrame.Visible = false
				Frames['Speed'].Visible = true
			end;
			10;
		};
		['Play Sound'] = {
			function()
				mainFrame.Visible = false
				Frames['Play Sound'].Visible = true
			end;
			11;
		};
		['Kill Player(s)'] = {
			function()
				local currentPlayers = players:GetPlayers()
				for _, child in pairs(Frames['Kill Player(s)']:GetChildren()) do
					if not child:IsA('UIGridLayout') then
						child:Destroy()
					end
					wait()
				end
				local killall = createButton('Kill All Players', 1, Frames['Kill Player(s)'])
				killall.BackgroundColor3 = Color3.fromRGB(165, 29, 24)
				killall.MouseButton1Down:Connect(function()
					for _, player in pairs(players:GetPlayers()) do
					    local char = player.Character
						if (char) then
							local torso = char:FindFirstChild('Torso')
							if (torso) then
								local root = game:GetService("Players").LocalPlayer.Character.HumanoidRootPart
								local pos = torso.Position
								local offset = pos-root.Position
								local originPos = root.Position
								root.CFrame = root.CFrame+offset
								gunShootEvent:FireServer(killPlayerConfig[1], killPlayerConfig[2], killPlayerConfig[3], killPlayerConfig[4], killPlayerConfig[5], torso, killPlayerConfig[7], killPlayerConfig[8], killPlayerConfig[9])
								pos = originPos
								offset = pos-root.Position
								root.CFrame = root.CFrame+offset
							end
						end
					end
				end)
				local killallexcept = createButton('Kill All Players, Except You', 2, Frames['Kill Player(s)'])
				killallexcept.BackgroundColor3 = Color3.fromRGB(165, 29, 24)
				killallexcept.MouseButton1Down:Connect(function()
					for _, player in pairs(players:GetPlayers()) do
						if player.Name ~= localplayer.Name then
						    local char = player.Character
							if (char) then
								local torso = char:FindFirstChild('Torso')
								if (torso) then
									local root = game:GetService("Players").LocalPlayer.Character.HumanoidRootPart
									local pos = torso.Position
									local offset = pos-root.Position
									local originPos = root.Position
									root.CFrame = root.CFrame+offset
									gunShootEvent:FireServer(killPlayerConfig[1], killPlayerConfig[2], killPlayerConfig[3], killPlayerConfig[4], killPlayerConfig[5], torso, killPlayerConfig[7], killPlayerConfig[8], killPlayerConfig[9])
									pos = originPos
									offset = pos-root.Position
									root.CFrame = root.CFrame+offset	
								end
							end
						end
					end
				end)
				for idx, player in pairs(currentPlayers) do
					local button = createButton(player.Name, idx + 2, Frames['Kill Player(s)'])
					button.MouseButton1Down:Connect(function()
						local char = player.Character
						if (char) then
							local torso = char:FindFirstChild('Torso')
							if (torso) then
								local root = game:GetService("Players").LocalPlayer.Character.HumanoidRootPart
								local pos = torso.Position
								local offset = pos-root.Position
								local originPos = root.Position
								root.CFrame = root.CFrame+offset
								gunShootEvent:FireServer(killPlayerConfig[1], killPlayerConfig[2], killPlayerConfig[3], killPlayerConfig[4], killPlayerConfig[5], torso, killPlayerConfig[7], killPlayerConfig[8], killPlayerConfig[9])
								pos = originPos
								offset = pos-root.Position
								root.CFrame = root.CFrame+offset
							end
						end
					end)
					wait()
				end
				Frames['Kill Player(s)'].CanvasSize = UDim2.new(0, 0, (2 * ((#currentPlayers + 1) / 4)), 0)
				Frames['Kill Player(s)'].UIGridLayout.CellPadding = UDim2.new(0.1, 0 , (0.002 / ((#currentPlayers + 1) / 4)), 0) 
				Frames['Kill Player(s)'].UIGridLayout.CellSize = UDim2.new(1, 0 , (0.05 / ((#currentPlayers + 1) / 4)), 0) 

				mainFrame.Visible = false
				Frames['Kill Player(s)'].Visible = true
			end;
			12;
		};
		['Auto-farm'] = {
			function()
				autoFarmOn = not(autoFarmOn)
				if (autoFarmOn) then
					mainFrame['Auto-farm'].Text = 'Auto-farm: On'
				else
					mainFrame['Auto-farm'].Text = 'Auto-farm: Off'
				end
			end;
			13;
		};
		['Chat'] = {
			function()
				chatGui.Enabled = not(chatGui.Enabled)
				if (chatGui.Enabled) then
					mainFrame['Chat'].Text = 'Chat: On'	
				else
					mainFrame['Chat'].Text = 'Chat: Off'	
				end			
			end;
			14;
		};
		['Delete GUI'] = {
			function()
				gui:Destroy()
				chatGui:Destroy()
				spectateGui:Destroy()
				script:Destroy()
			end;
			15;
		}
	}
	
	spawn(function()
		while wait(0.1) do
			if (autoFarmOn) then
				pcall(function()
					replicatedStorage.Jobs.Done:FireServer('Restocker')
	  				replicatedStorage.Jobs.Done:FireServer('Cashier')
				end)
			end
			
		end
	end)
	
	spawn(function()
		while wait(0.04) do
			if (playingSong) then
				pcall(function()
					local car = workspace.SpawnedCars[localplayer.Name]
					local PlaySoundEvent = car["AC6_FE_Sounds"]
					car.DriveSeat.Rev.Playing = true
					--PlaySoundEvent:FireServer("playSound", "Rev")
					PlaySoundEvent:FireServer("updateSound", "Rev", songID, 1, songVolume)
				end)
			end
		end
	end)
	
	
	for key, buttonInfo in pairs(mainScreenButtonFunctions) do
		local button = createButton(key, buttonInfo[2], mainFrame)
		button.MouseButton1Down:Connect(buttonInfo[1])
	end
	
	mainFrame['Auto-farm'].Text = 'Auto-farm: Off'
	mainFrame['Chat'].Text = 'Chat: Off'	
	
	local function changeWalkSpeed(textFrame)
		local success = pcall(function()
			humanoid.WalkSpeed = tonumber(textFrame.Text)
			currentWalkSpeed = originWalkSpeed
		end)
		if (success and (tonumber(textFrame.Text) ~= nil)) then
			textFrame.Text = 'Speed set!'
			delay(2, function()
				textFrame.Text = tostring(humanoid.WalkSpeed)
			end)
		else
			humanoid.WalkSpeed = originWalkSpeed
			currentWalkSpeed = originWalkSpeed
			textFrame.Text = 'Speed change failed!'
			delay(2, function()
				textFrame.Text = tostring(humanoid.WalkSpeed)
			end)
		end
	end
	
	local speedTextBox = Instance.new('TextBox', Frames['Speed'])
	speedTextBox.Text = tostring(humanoid.WalkSpeed)
	speedTextBox.PlaceholderText = '16 is default.'
	speedTextBox.Font = Enum.Font.Cartoon
	speedTextBox.TextScaled = true
	speedTextBox.BorderSizePixel = 0
	speedTextBox.LayoutOrder = 3
	speedTextBox.ZIndex = Frames['Speed'].ZIndex + 1
	speedTextBox.BackgroundTransparency = 1
	speedTextBox.FocusLost:Connect(function(enterPressed)
		if (enterPressed) then
			changeWalkSpeed(speedTextBox)
		end
	end)
	
	local setSpeedButton = createButton('Set', 4, Frames['Speed'])
	setSpeedButton.MouseButton1Down:Connect(function()
		changeWalkSpeed(speedTextBox)
	end)
	
	local resetSpeedButton = createButton('Reset', 5, Frames['Speed'])
	resetSpeedButton.MouseButton1Down:Connect(function()
		humanoid.WalkSpeed = originWalkSpeed
		currentWalkSpeed = originWalkSpeed
		speedTextBox.Text = 'Reset!'
		delay(2, function()
			speedTextBox.Text = tostring(humanoid.WalkSpeed)
		end)
	end)
	
	local songIDBox = Instance.new('TextBox', Frames['Play Sound'])
	songIDBox.Text = "168983825"
	songIDBox.PlaceholderText = 'Put song ID here'
	songIDBox.Font = Enum.Font.Cartoon
	songIDBox.TextScaled = true
	songIDBox.BorderSizePixel = 0
	songIDBox.LayoutOrder = 3
	songIDBox.ZIndex = Frames['Play Sound'].ZIndex + 1
	songIDBox.BackgroundTransparency = 1
	songIDBox.FocusLost:Connect(function(enterPressed) print("beans") end)
	
	local volumeBox = Instance.new('TextBox', Frames['Play Sound'])
	volumeBox.Text = "10"
	volumeBox.PlaceholderText = 'Set Volume, 0-10'
	volumeBox.Font = Enum.Font.Cartoon
	volumeBox.TextScaled = true
	volumeBox.BorderSizePixel = 0
	volumeBox.LayoutOrder = 3
	volumeBox.ZIndex = Frames['Play Sound'].ZIndex + 2
	volumeBox.BackgroundTransparency = 1
	volumeBox.FocusLost:Connect(function(enterPressed) print("beans") end)
	
	local setSongID = createButton('Set Sound ID', 5, Frames['Play Sound'])
	setSongID.MouseButton1Down:Connect(function()
		local PlaySoundEvent = workspace.SpawnedCars[localplayer.Name]["AC6_FE_Sounds"]
		songID = "rbxassetid://" .. songIDBox.Text
	end)
	
	local setVolume = createButton('Set Volume', 6, Frames['Play Sound'])
	setVolume.MouseButton1Down:Connect(function()
		local PlaySoundEvent = workspace.SpawnedCars[localplayer.Name]["AC6_FE_Sounds"]
		songVolume = tonumber(volumeBox.Text)
	end)
	
	local playSong = createButton('Play Sound', 7, Frames['Play Sound'])
	playSong.MouseButton1Down:Connect(function()
		pcall(function()
			local car = workspace.SpawnedCars[localplayer.Name]
			local PlaySoundEvent = car["AC6_FE_Sounds"]
			songVolume = tonumber(volumeBox.Text)
			PlaySoundEvent:FireServer("updateSound", "Rev", songID, 1, songVolume)
			PlaySoundEvent:FireServer("playSound", "Rev")
		end)
		playingSong = true
	end)
	
	local stopSong = createButton('Stop Sound', 8, Frames['Play Sound'])
	stopSong.MouseButton1Down:Connect(function()
		playingSong = false
		if not pcall(function()
			local car = workspace.SpawnedCars[localplayer.Name]
			local PlaySoundEvent = car["AC6_FE_Sounds"]
			car.DriveSeat.Rev.Playing = false
			songVolume = "F"
		end) then print("Error stopping sound") end
	end)
	
	tweenService:Create(loadingFrame, TweenInfo.new(2, Enum.EasingStyle.Quart, Enum.EasingDirection.Out), {Position = UDim2.new(0, 0, -1, 0)}):Play()
	humanoid.Died:Connect(function()
		character = localplayer.CharacterAdded:Wait()
		humanoidRootPart = character:WaitForChild('HumanoidRootPart')
		humanoid = character:WaitForChild('Humanoid')
		currentCamera = workspace.CurrentCamera
		createGui()
	end)
end

createGui()